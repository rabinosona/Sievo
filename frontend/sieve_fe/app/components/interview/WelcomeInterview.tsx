import { Button, TextInput } from "@mantine/core";
import { useForm } from "@mantine/form";
import { useEffect } from "react";
import { ButtonSize } from "~/styles/ButtonStyles";
import { CenteredClass } from "~/styles/PositioningStyles";
import { WelcomeTextStyle } from "~/styles/TextStyles";

export default function Index({
  handleRequestMicrophonePermission,
  handleSubmit,
}) {
  const form = useForm({
    mode: "uncontrolled",
    initialValues: {
      email: "",
      termsOfService: false,
    },

    validate: {
      email: (value) => (/^\S+@\S+$/.test(value) ? null : "Invalid email"),
    },
  });

  return (
    <div className="flex h-screen items-start justify-center">
      <div className="flex flex-col items-stretch w-screen justify-between">
        <header className={`flex flex-col items-center gap-28 w-full h-full`}>
          <div className="flex flex-row items-center justify-center p-6">
            <svg
              width="184"
              height="48"
              viewBox="0 0 184 48"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                fill-rule="evenodd"
                clip-rule="evenodd"
                d="M10.8531 6.65045L9.26695 5.06163C5.96177 7.63981 3.34771 11.0653 1.74994 15.0124C9.79168 15.571 16.8279 19.7807 21.2122 25.9953C19.7474 18.7225 16.1721 11.9786 10.8531 6.65045ZM13.6839 3.82445L12.6917 2.83058C16.0612 1.02425 19.9112 0 24 0C28.0783 0 31.919 1.01897 35.2822 2.81662L34.2761 3.82445C29.499 8.6097 25.9945 14.428 23.98 20.7537C21.9655 14.428 18.461 8.6097 13.6839 3.82445ZM37.1069 6.65045L38.7105 5.0441C42.0256 7.6237 44.6475 11.0548 46.249 15.0097C38.191 15.5574 31.1392 19.7707 26.7478 25.9953C28.2126 18.7225 31.7879 11.9786 37.1069 6.65045ZM26 40.9902C26 29.0107 35.5568 19.2634 47.4622 18.9565C47.8145 20.5955 48 22.2966 48 24.0411C48 36.644 38.3191 46.982 26 48V40.9902ZM21.96 40.9902V47.9967C9.65999 46.9596 0 36.6304 0 24.0411C0 22.297 0.185416 20.5962 0.537578 18.9575C12.4245 19.2852 21.96 29.0241 21.96 40.9902Z"
                fill="#C4C3D4"
              />
              <path
                fill-rule="evenodd"
                clip-rule="evenodd"
                d="M81.4805 30.1523C81.6628 30.5951 81.7539 31.0703 81.7539 31.5781C81.7539 32.0859 81.6497 32.5547 81.4414 32.9844C81.2331 33.401 80.9336 33.7591 80.543 34.0586C80.1523 34.3581 79.6706 34.5924 79.0977 34.7617C78.5378 34.931 77.8932 35.0156 77.1641 35.0156C76.3438 35.0156 75.5885 34.9245 74.8984 34.7422C74.2214 34.5599 73.6419 34.2734 73.1602 33.8828C72.6654 33.4922 72.2812 32.9909 72.0078 32.3789C71.7344 31.7669 71.5846 31.0312 71.5586 30.1719H66.168C66.168 31.6432 66.4479 32.9258 67.0078 34.0195C67.5807 35.1133 68.3555 36.0638 69.332 36.8711C70.3607 37.6914 71.5651 38.3164 72.9453 38.7461C74.3385 39.1628 75.7448 39.3711 77.1641 39.3711C78.6094 39.3711 79.944 39.2018 81.168 38.8633C82.3919 38.5117 83.4466 37.9974 84.332 37.3203C85.2174 36.6562 85.9076 35.8424 86.4023 34.8789C86.9102 33.9023 87.1641 32.7891 87.1641 31.5391C87.1641 30.0938 86.832 28.8177 86.168 27.7109C85.5039 26.6042 84.612 25.6341 83.4922 24.8008C82.75 24.293 81.9362 23.8438 81.0508 23.4531C80.1654 23.0625 79.2344 22.7305 78.2578 22.457C77.3464 22.2096 76.526 21.9427 75.7969 21.6562C75.0807 21.3698 74.4688 21.0508 73.9609 20.6992C73.4531 20.3607 73.0625 19.9766 72.7891 19.5469C72.5286 19.1172 72.3984 18.6354 72.3984 18.1016C72.3984 17.5938 72.4961 17.125 72.6914 16.6953C72.8997 16.2526 73.1992 15.8685 73.5898 15.543C73.9805 15.2305 74.4557 14.9896 75.0156 14.8203C75.5885 14.638 76.2396 14.5469 76.9688 14.5469C77.763 14.5469 78.4531 14.6576 79.0391 14.8789C79.638 15.0872 80.1393 15.3802 80.543 15.7578C80.9336 16.1484 81.2266 16.6107 81.4219 17.1445C81.6302 17.6784 81.7474 18.2643 81.7734 18.9023H87.125C87.125 17.6263 86.8776 16.4544 86.3828 15.3867C85.888 14.319 85.1979 13.3945 84.3125 12.6133C83.4271 11.8451 82.3659 11.2461 81.1289 10.8164C79.9049 10.3867 78.5508 10.1719 77.0664 10.1719C75.6341 10.1719 74.306 10.3607 73.082 10.7383C71.8581 11.1029 70.7969 11.6302 69.8984 12.3203C69 13.0104 68.2969 13.8438 67.7891 14.8203C67.2812 15.7969 67.0273 16.8841 67.0273 18.082C67.0273 19.1237 67.2161 20.0872 67.5938 20.9727C67.9844 21.8581 68.5573 22.6654 69.3125 23.3945C70.0677 24.1237 71.0378 24.7943 72.2227 25.4062C73.4206 26.0182 74.8073 26.5391 76.3828 26.9688C77.3984 27.2422 78.2448 27.5417 78.9219 27.8672C79.612 28.1797 80.1719 28.5247 80.6016 28.9023C81.0182 29.293 81.3112 29.7096 81.4805 30.1523ZM104.156 17.8672H92.6523V22.3008H98.668V34.5859H92.6523V39H109.879V34.5859H104.156V17.8672ZM98.4922 11.3047C98.349 11.6562 98.2773 12.0404 98.2773 12.457C98.2773 12.8737 98.349 13.2643 98.4922 13.6289C98.6484 13.9805 98.8633 14.2799 99.1367 14.5273C99.4102 14.7878 99.7357 14.9896 100.113 15.1328C100.504 15.276 100.934 15.3477 101.402 15.3477C102.366 15.3477 103.128 15.0807 103.688 14.5469C104.26 14 104.547 13.3034 104.547 12.457C104.547 11.6107 104.26 10.9206 103.688 10.3867C103.128 9.83984 102.366 9.56641 101.402 9.56641C100.934 9.56641 100.504 9.63802 100.113 9.78125C99.7357 9.92448 99.4102 10.1198 99.1367 10.3672C98.8633 10.6276 98.6484 10.9401 98.4922 11.3047ZM121.051 38.5898C122.379 39.1237 123.857 39.3906 125.484 39.3906C127.529 39.3906 129.299 38.9935 130.797 38.1992C132.294 37.4049 133.388 36.5195 134.078 35.543L131.363 32.6133C130.738 33.4206 129.924 34.026 128.922 34.4297C127.919 34.8333 126.884 35.0352 125.816 35.0352C125.061 35.0352 124.365 34.918 123.727 34.6836C123.089 34.4492 122.522 34.1172 122.027 33.6875C121.546 33.2708 121.161 32.8086 120.875 32.3008C120.589 31.7799 120.354 31.0964 120.172 30.25V30.1914H134.508V27.8867C134.508 26.3372 134.293 24.9245 133.863 23.6484C133.434 22.3594 132.809 21.2591 131.988 20.3477C131.155 19.4362 130.139 18.7331 128.941 18.2383C127.757 17.7305 126.402 17.4766 124.879 17.4766C123.408 17.4766 122.047 17.7435 120.797 18.2773C119.547 18.8112 118.466 19.5599 117.555 20.5234C116.643 21.487 115.934 22.6393 115.426 23.9805C114.918 25.3086 114.664 26.7799 114.664 28.3945V29.1758C114.664 30.5951 114.918 31.9297 115.426 33.1797C115.947 34.4167 116.682 35.4909 117.633 36.4023C118.583 37.3268 119.723 38.056 121.051 38.5898ZM123.16 22.2031C123.668 21.9818 124.228 21.8711 124.84 21.8711C125.53 21.8711 126.135 21.9818 126.656 22.2031C127.19 22.4115 127.639 22.6979 128.004 23.0625C128.368 23.4401 128.655 23.8828 128.863 24.3906C129.072 24.8984 129.176 25.4388 129.176 26.0117V26.4414H120.27C120.4 25.7513 120.595 25.1263 120.855 24.5664C121.116 24.0065 121.441 23.5247 121.832 23.1211C122.21 22.7174 122.652 22.4115 123.16 22.2031ZM137.906 17.8672L145.973 39H151.07L159.098 17.8672H153.434L148.805 32.7695L148.512 34.2539L148.219 32.7695L143.57 17.8672H137.906ZM163.199 23.9805C162.757 25.2826 162.535 26.7018 162.535 28.2383V28.6484C162.535 30.1979 162.757 31.6302 163.199 32.9453C163.642 34.2474 164.293 35.3802 165.152 36.3438C165.999 37.3073 167.04 38.0625 168.277 38.6094C169.527 39.1432 170.947 39.4102 172.535 39.4102C174.111 39.4102 175.517 39.1432 176.754 38.6094C177.991 38.0625 179.033 37.3073 179.879 36.3438C180.725 35.3802 181.37 34.2474 181.812 32.9453C182.255 31.6302 182.477 30.1979 182.477 28.6484V28.2383C182.477 26.7018 182.255 25.2826 181.812 23.9805C181.37 22.6654 180.725 21.526 179.879 20.5625C179.02 19.599 177.971 18.8438 176.734 18.2969C175.497 17.75 174.085 17.4766 172.496 17.4766C170.908 17.4766 169.495 17.75 168.258 18.2969C167.034 18.8438 165.999 19.599 165.152 20.5625C164.293 21.526 163.642 22.6654 163.199 23.9805ZM168.219 31.1484C168.049 30.3672 167.965 29.5339 167.965 28.6484V28.2383C167.965 27.3789 168.049 26.5651 168.219 25.7969C168.388 25.0286 168.655 24.3516 169.02 23.7656C169.384 23.1797 169.853 22.7174 170.426 22.3789C170.999 22.0404 171.689 21.8711 172.496 21.8711C173.316 21.8711 174.013 22.0404 174.586 22.3789C175.159 22.7174 175.628 23.1797 175.992 23.7656C176.344 24.3516 176.604 25.0286 176.773 25.7969C176.943 26.5651 177.027 27.3789 177.027 28.2383V28.6484C177.027 29.5339 176.943 30.3672 176.773 31.1484C176.604 31.9167 176.344 32.5872 175.992 33.1602C175.628 33.7461 175.159 34.2083 174.586 34.5469C174.013 34.8854 173.329 35.0547 172.535 35.0547C171.715 35.0547 171.012 34.8854 170.426 34.5469C169.853 34.2083 169.384 33.7461 169.02 33.1602C168.655 32.5872 168.388 31.9167 168.219 31.1484Z"
                fill="#C4C3D4"
              />
            </svg>
          </div>
          <h1 className="leading text-2xl font-bold text-gray-800 dark:text-gray-100 w-1/2 h-full">
            <div style={{ pointerEvents: "none" }}>
              <div className="flex flex-col items-center justify-center gap-8 w-full">
                <div
                  className="w-1/3 gap-4 text-center text-xl"
                  style={WelcomeTextStyle}
                >
                  <div className={CenteredClass}>
                    Hi! I'm Sievo, your interactive interviewer
                  </div>
                  <div className={CenteredClass}>
                    I will ask you a few questions toÂ learn more about your
                    skills and experience
                  </div>
                  <div className={CenteredClass}>
                    Please click the Test button and allow microphone access
                    when you're ready to start
                  </div>
                </div>
              </div>
            </div>
          </h1>
        </header>
        <div className="pb-12">
          <div className="flex flex-col items-center justify-center gap-2">
            <form
              className="flex flex-col gap-4 items-center justify-center pt-2 rounded-3xl w-screen"
              onSubmit={form.onSubmit(async (v) => {
                console.log("han");
                await handleRequestMicrophonePermission();
                handleSubmit(v);
              })}
            >
              <TextInput
                placeholder="Email"
                className="w-1/6"
                key={form.key("email")}
                {...form.getInputProps("email")}
              ></TextInput>
              <Button type="submit" className={ButtonSize}>
                Begin Interview
              </Button>
            </form>
          </div>
        </div>
      </div>
    </div>
  );
}
